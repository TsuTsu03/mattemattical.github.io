<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Dashboard | Algal Carbon Capturing Tool</title>
  <link rel="stylesheet" href="/CSS/main.css">
  <link rel="stylesheet" href="/CSS/navbar.css">
  <link rel="stylesheet" href="/lib/w3schools28.css">
  <script src="/JS/bootstrap.js"></script>
  <link rel="icon" href="/Images/falcalogo.png">

  <!-- Bootstrap 4.5 CSS-->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
    integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
  
  <!-- Bootstrap JS Requirements -->
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
    integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
    integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"
    integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV" crossorigin="anonymous"></script>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script>
  <link rel="stylesheet" href="//cdn.materialdesignicons.com/3.7.95/css/materialdesignicons.min.css">

</head>
<style>
  .buttonON {
  display: inline-block !important;
  padding: 5px 10px !important;
  font-weight: bold !important;
  cursor: pointer !important;
  text-align: center !important;
  text-decoration: none !important;
  outline: none !important;
  color: #fff !important;
  background-color: #4CAF50 !important;
  border: none !important;
  border-radius: 15px !important;
  box-shadow: 0 5px #999 !important;
}

.buttonON:hover {background-color: #3e8e41 !important}
.buttonON:active {
  background-color: #3e8e41 !important;
  box-shadow: 0 1px #666 !important;
  transform: translateY(4px) !important;
}

.buttonOFF {
  display: inline-block !important;
  padding: 5px 10px !important;
  font-weight: bold !important;
  cursor: pointer !important;
  text-align: center !important;
  text-decoration: none !important;
  outline: none !important;
  color: #fff !important;
  background-color: #e74c3c !important;
  border: none !important;
  border-radius: 15px !important;
  box-shadow: 0 5px #999 !important;
}

.buttonOFF:hover {background-color: #c0392b !important}
.buttonOFF:active {
  background-color: #c0392b !important;
  box-shadow: 0 1px #666 !important;
  transform: translateY(4px) !important;
}

.text {
  text-align: center;
  font-size: 18px;
  width: 200px;
  height: 22px;
  border: 3px solid #9b59b6;
  border-radius: 5px;
  padding: 3px;
  -webkit-transition: border 0.5s ease-in-out, box-shadow 0.5s ease-in-out;
  -moz-transition: border 0.5s ease-in-out, box-shadow 0.5s ease-in-out;
  -ms-transition: border 0.5s ease-in-out, box-shadow 0.5s ease-in-out;
  -o-transition: border 0.5s ease-in-out, box-shadow 0.5s ease-in-out;
  transition: border 0.5s ease-in-out, box-shadow 0.5s ease-in-out;
}

.text:focus {
  border: 3px solid #8e44ad;
  box-shadow: 0 0 7px #8e44ad;
  outline: none;
}
</style>

<body>
  <!-- Modal -->
  <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalCenterTitle">Reminder</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <p>Before using the device, please read the manual carefully. Refer to the manual page</p>
        </div>
        <div class="modal-footer">
          <!-- Make sure to include the 'nothanks' class on the buttons -->
          <div class="checkbox"><label><input type="checkbox"> Don't show this again!</label></div>
          <a href="/HTML/manual.html" class="btn btn-primary">Go to Manual Page</a>
        </div>
      </div>
    </div>
  </div>

  <nav class="navbar navbar-expand-lg fixed-top navbar-dark dark" style="padding-left: 20px;">  
    <div class="container-fluid">
      <div class="line padding-20">
        <a class="navbar-brand" href="/HTML/index.html"> <img src="/Images/falcalogo (Custom).png"
            alt="falcalogo">&nbsp AC<sup>2</sup>T </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarColor03"
          aria-controls="navbarColor03" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
      </div>
      <div class="collapse navbar-collapse " id="navbarColor02">
        <ul class="navbar-nav me-auto navbar-nav-scroll">
          <li class="nav-item">
            <a class="nav-link active" href="/HTML/index.html">Dashboard
              <!-- <span class="visually-hidden">(current)</span> -->
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#graphs">Graphs</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#control">Control</a>
          </li>
        </ul>
        <ul class="navbar-nav flex-row ml-md-auto d-none d-md-flex">
          <li class="nav-item dropdown">
            <a class="nav-item nav-link dropdown-toggle mr-md-2" href="#" id="bd-versions" data-toggle="dropdown"
              aria-haspopup="true" aria-expanded="false">
              Help
            </a>
            <div class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-versions">
              <a class="dropdown-item" href="/HTML/manual.html">Manual</a>
              <a class="dropdown-item" href="/HTML/faqs.html">FAQs</a>
              <div class="dropdown-divider"></div>
              <a class="dropdown-item" href="/HTML/aboutus.html">About Us</a>
        
            </div>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <div style="background: url(/Images/bgpol.jpg); margin-top: 60px; margin-bottom: 0; height: 600px;" class="jumbotron bg-cover text-white">
    <div class="container py-5 text-center">
      <h1 class="display-3 font-weight-bold" style="margin: 100px 0 0 0;">Welcome to Dashboard</h1>
      <p class="font-italic mb-0">Algal Carbon Capturing Tool.</p>
    </div>
  </div>

  <div class="bg-light py-5" id="graphs">
    <div class="container py-5">
      <div class="row mb-4">
        <div class="col">
          <h2 >Graphs</h2>
          <p class="font-italic">Following graphs are the graphical view of data collected by the sensors</p>
        </div>
      </div>
      <div class="row mb-5 justify-content-center">
        <div class="col-lg-5"> 
          <div class="card">
            <div class="card-header"><b>Graph 1:</b> Humidity</div> 
            <!-- iframe width="540" height="260" -->
          <iframe width="445" height="260" style="border: 1px solid #cccccc;"
            src="https://thingspeak.com/channels/1510102/charts/1?bgcolor=%23ffffff&color=%23ffff00&dynamic=true&results=10&title=Humidity&type=line"></iframe>
          </div>
        </div>
        <div class="col-lg-5">
          <div class="card">
            <div class="card-header"><b>Graph 2:</b> Water Temperature</div>
            <iframe width="445" height="260" style="border: 1px solid #cccccc;"
              src="https://thingspeak.com/channels/1510102/charts/2?bgcolor=%23ffffff&color=%232596be&dynamic=true&results=10&title=Water+Temperature&type=line"></iframe>

          </div>
        </div>
      </div>
      
      <!-- next row -->
      <div class="row mb-5 justify-content-center">
        <div class="col-lg-5">
          <div class="card">
            <div class="card-header"><b>Graph 3:</b> Room Temperature</div>
            <iframe width="440" height="260" style="border: 1px solid #cccccc;"
              src="https://thingspeak.com/channels/1510102/charts/3?bgcolor=%23ffffff&color=%23e83845&dynamic=true&results=10&title=Room+Temperature&type=line"></iframe>

          </div>
        </div>
        <div class="col-lg-5">
          <div class="card">
            <div class="card-header"><b>Graph 4:</b> Light Intensity</div>
            <iframe width="440" height="260" style="border: 1px solid #cccccc;"
              src="https://thingspeak.com/channels/1510102/charts/4?bgcolor=%23ffffff&color=%23eb96eb&dynamic=true&results=10&title=Light+Intensity&type=line"></iframe>

          </div>
        </div>
      </div>

      <!-- next row -->
      <div class="row justify-content-center">
        <div class="col-lg-5">
          <div class="card">
            <div class="card-header"><b>Graph 5:</b> Turbidity</div>
            <iframe width="440" height="260" style="border: 1px solid #cccccc;"
              src="https://thingspeak.com/channels/1510102/charts/5?bgcolor=%23ffffff&color=%23808080&dynamic=true&results=10&title=Turbidity&type=line"></iframe>
          </div>
        </div>
        <div class="col-lg-5">
          <div class="card">
            <div class="card-header"><b>Graph 6:</b> Concentration</div>
            <iframe width="440" height="260" style="border: 1px solid #cccccc;"
              src="https://thingspeak.com/channels/1510102/charts/6?bgcolor=%23ffffff&color=%23299438&dynamic=true&results=10&title=Concentration&type=line"></iframe>
          </div>
        </div>
      </div>

      <!-- next row -->
      <div class="row justify-content-center">
        <div class="col-lg-5">
          <div class="card">
            <div class="card-header"><b>Graph 7:</b> pH level</div>
            <iframe width="440" height="260" style="border: 1px solid #cccccc;"
              src="https://thingspeak.com/channels/1510102/charts/7?bgcolor=%23ffffff&color=%23323232&dynamic=true&results=10&title=pH+Level&type=line"></iframe>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="bg-light py-5" id="control">
    <div class="container py-5">
      <div class="row mb-4">
        <div class="col">
          <h2>Control</h2>
          <p class="font-italic">Select Actuator by using the dropdown below</p>
        </div>
      </div>
      <div>
        <table class="table">
          <thead>
            <tr>
              <th><select id="fields" class="form-control" aria-label="Default select example">
                <option selected>Select Actuator</option>
                <option value="1">Solenoid Water Source</option>
                <option value="2">Solenoid Harvesting</option>
                <option value="3">Solenoid Sprinkler</option>
                <option value="4">Water Pump Water Source</option>
                <option value="5">Light Panel</option>
                <option value="6">Operational Control</option>
              </select></th>
              <th><button type="button" id="relayon" class="buttonON" >ON</button></th>
              <th><button type="button" id="relayoff" class="buttonOFF" >OFF</button></th>
              <th> Status:&nbsp;<span id="relaystate">Please wait...</span></th>
            </tr>
          </thead>
        </table>
      </div>
  <footer class="bg-light pb-5">
    <div class="container text-center">
      <img src="/Images/falcalogo (Custom).png">
      <p class="font-italic text-muted mb-0">&copy; Team ACCT </p>
    </div>
  </footer>

  <script type="text/javascript">
    $(window).on('load', function() {
        $('#myModal').modal('show');
    });

    document.getElementById('relayon').addEventListener('click', function() {
				var fields = document.getElementById('fields').value;
				var url = "http://api.thingspeak.com/update?api_key=CTU5MR5NY2R41PAQ&field"+ fields +"=1"
				$.getJSON(url, function(data) {
					console.log(data);
				});
			});
		
		document.getElementById('relayoff').addEventListener('click', function() {
				var fields = document.getElementById('fields').value;
				var url = "http://api.thingspeak.com/update?api_key=CTU5MR5NY2R41PAQ&field"+ fields +"=0"
				$.getJSON(url, function(data) {
					console.log(data);
				});
			});
			
			setInterval(function() {
			// Call a function repetatively with 15 Second interval
				getThingSpeakLightState();
			}, 15000);
			
			function getThingSpeakLightState() {
				var fields = document.getElementById('fields').value;
				var xhttp = new XMLHttpRequest();
				xhttp.onreadystatechange = function() {
					if (this.readyState == 4 && this.status == 200) {
						var myObj = JSON.parse(this.responseText);
            var newObj = obj = Object.values(myObj)[2];
						if (newObj== "1") {
							document.getElementById("relaystate").innerHTML = "ON";
						}
						else {
							document.getElementById("relaystate").innerHTML = "OFF";
						}
					}
				};
				xhttp.open("GET", "https://api.thingspeak.com/channels/1690323/fields/"+ fields +"/last.json", true);
				xhttp.send();
			}
  </script> 

</body>

</html>